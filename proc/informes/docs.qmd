---
title: "Más allá del desempeño. Brechas de autoeficacia tecnológica y composición de género en contextos escolares chilenos"
author: Juan Carlos Castillo, Daniel Miranda y Nicolás Tobar
bibliography: ../../input/bib/icils_nudos.bib 
csl: ../../input/bib/apa.csl

knitr:
  opts_chunk: 
    collapse: true
    comment: "#>" 
    R.options:
      knitr.graphics.auto_pdf: true
      
format: 
  revealjs:
    logo: images/banner_nudos.jpg
    slide-number: true
    theme: [pp.scss]
    title-slide-attributes:
      data-background-image: images/portada.jpg
      data-background-size: cover
      
editor: visual
---

```{r}
options(digits = 2) #round results to 2 digits

nudos_color_binary <- c("#5f5758","#ff3057") #Nudos theme

pacman::p_load(tidyverse, #Data manipulation
               stargazer, #Descriptive tables
               sjmisc, #Descriptive tables
               knitr, #Markdown
               corrr, #Correlation matrix
               sjlabelled, #Labels manipulation
               sjPlot, #View_df table
               Hmisc, #Manipulate labels
               ggplot2, #Plots
               hrbrthemes, #Plot themes
               labelled, #Manipulate labels
               ggExtra, #Marginal plots
               gt, #Tables
               googlesheets4, #open sheets google
               summarytools, #Summary tables
               haven, #read_sav
               corrplot, #Plot corr
               lme4, #Multilevel modelo
               interactions #View multilevel interactions
               )

data <- readRDS("../../input/proc_data/03_student_proc_2018.rds")

#Student level
student <- data %>% select(starts_with("s_"))

#School level
school <- data %>% select(starts_with("c_"),idschool) %>% group_by(idschool) %>% 
                  summarise(across(everything(),~ mean(.x, na.rm = TRUE))) %>% ungroup() %>%
                  select(-idschool)

#Recode HISCED
student <- student %>% mutate(s_hisced=ifelse(to_numeric(s_hisced)==4,1,0))
```

# Introducción

## Problema {.smaller}

::: incremental
-   Masificación TICS y diferencias de uso por género [@hargittaiDifferencesActualPerceived2006;@punterGenderDifferencesComputer2017].
-   Encuesta ICILS IEA [@gebhardtGenderDifferencesComputer2019]:
    -   Estudio a nivel internacional para medir y evaluar la alfabetización computacional y el manejo de información de los estudiantes de 8ºgrado (13-14 años).
    -   Dos instrumentos: Test de pensamiento computacional y cuestionario sobre acceso, uso, percepciones y actitudes a las TIC.
    -   En 2013 Y 2018 las mujeres lograron puntajes más altos que los hombres. **En Chile estas diferencias tienden a no ser significativas**.
    -   Hombres reportan mayor autoeficacia avanzada, pero correlaciona menos con el puntaje del test que en las mujeres. Subestimación femenina.
-   La sociología de brechas digitales se ha enfocado en cómo los recursos habilitan el desempeño. @rosaResonanciaSociologiaRelacion2019 enfatiza en la pregunta ética: Relaciones logradas con las TIC.
-   El rol de la expectativas de autoeficacia en la autodeterminación individual y la valoración del entorno [@ryanSelfdeterminationTheoryFacilitation2000].

:::

## Identidad, grupos de referencia y estereotipo {.smaller}

::: incremental

-   Teorías de Grupos de referencia y Amenaza del esterotipo [@turnerSocialIdentityTheory2004;@steeleStereotypeThreatIntellectual1995] explican que las personas disminuyen su desempeño cuando se les recuerda que pertenecen a un grupo desfavorecido.
-   @vekiriGenderIssuesTechnology2008 muestran que los niños reciben mayor apoyo de padres y de sus compañeros que las niñas. Como consecuencia, se sienten más capaces en el uso de tecnologías, crecen con mayor valoración social de ellas y tienen mayor motivación hacia las tecnologías que sus compañeras.
-   Estudios de composición de género: Hallazgos demuestran que las mujeres aumentan su rendimiento y satisfacción laboral y académica cuando están rodeadas de directivas y colegas mujeres [@kirschGenderCompositionCorporate2018].
    -   Ausencia de estudios de composición con ICILS y oportunidad de aproximarse a este efecto multinivel.
    
:::

# Pregunta

**¿Cómo la composición de género del establecimiento y las actitudes hacia las tecnologías afectan las expectativas de autoeficacia sobre las tecnologías de los hombres y las mujeres estudiantes de octavo básico en Chile?**

## Modelo Analítico

<div style="text-align: center;">
![](images/nivel1_diagram.png)
</div>

## Modelo Analítico

<div style="text-align: center;">
![](images/multilevel_diagram.png)
</div>


# Nivel 1: Estudiantes

## Género, autoeficacia y valoración social

```{r}
data %>% group_by(to_label(s_sex)) %>% rename(gender="to_label(s_sex)")%>%
  summarise_at(c(autoeficacia_general="s_geneff",autoeficacia_especifica="s_speceff",
                 ict_positiva="s_ictpos",ict_negativa="s_ictneg",ict_futuro="s_ictfut"),
                 mean, na.rm = TRUE)%>%
  pivot_longer(cols = starts_with(c("auto","ict")),
               names_to = "indicadores",
               values_to = "puntaje")%>%
  mutate(indicadores=factor(indicadores, levels=c("ict_negativa",
                                                  "ict_positiva",
                                                  "ict_futuro",
                                                  "autoeficacia_general",
                                                  "autoeficacia_especifica"),
                                          labels=c("Valoración social negativa",
                                                   "Valoración social positiva",
                                                   "Expectativas de uso laboral o académico futuro",
                                                   "Autoeficacia en aplicaciones generales",
                                                   "Autoeficacia en aplicaciones específicas")))%>%
  
  ggplot(aes(x=to_label(puntaje),y=to_label(indicadores),color=gender))+
    geom_line(aes(group=to_label(indicadores)),color="#E7E7E7",linewidth=2.0)+
    geom_point(size=6)+
    theme_ipsum()+
    labs(x="Puntaje promedio",y="Indicadores",color="Género")+
    scale_color_manual(values=nudos_color_binary)+
    theme(legend.position = "top")+
    scale_y_discrete(labels=function(x) str_wrap(x,width = 40))
```

## Relaciones de varianza

::: panel-tabset

###### Hombres
```{r}
student %>% filter(s_sex==0) %>% 
  select("A. General"=s_geneff, "A. Específica"=s_speceff, "Expectativas uso futuro"=s_ictfut,
         "Valoración positiva"=s_ictpos,"Valoración negativa"=s_ictneg)%>%drop_na()%>%
  cor()%>%
  corrplot(method="square",diag = FALSE,type = "lower",addCoef.col = "#5f5758")
```

###### Mujeres
```{r}
student %>% filter(s_sex==1) %>% 
  select("A. General"=s_geneff, "A. Específica"=s_speceff, "Expectativas uso futuro"=s_ictfut,
         "Valoración positiva"=s_ictpos,"Valoración negativa"=s_ictneg)%>%drop_na()%>%
  cor()%>%
  corrplot(method="square",diag = FALSE,type = "lower",addCoef.col = "#5f5758")
```

:::

# Nivel 2: Escuelas

## Autoeficacia y establecimientos {.smaller}

::: panel-tabset
#### Autoeficacia General

```{r}
ggMarginal(school%>%mutate(c_p_sex=recode(c_p_sex,"1"="Mujer","0"="Hombre")) %>% drop_na(c_p_sex)%>%
             ggplot(aes(x=c_f_ratio_grade,y=c_geneff,color=c_p_sex))+
             geom_point(color="grey")+
             scale_color_manual(values = nudos_color_binary)+
             geom_smooth(method = "nls", formula = y ~ a * x + b, se = F,
             method.args = list(start = list(a = 0.1, b = 0.1)))+    
             theme_ipsum()+
             labs(x = "Ratio de mujeres 8vo básico (estimado)",
                  y = "Promedio por escuela de autoeficacia general",
                  color= "Género directivo")+
             theme(legend.position = "bottom")+
             scale_x_continuous(labels = scales::percent_format(scale = 100)),
           type = "boxplot")
```

#### Autoeficacia específica

```{r}
ggMarginal(school%>%mutate(c_p_sex=recode(c_p_sex,"1"="Mujer","0"="Hombre")) %>% drop_na(c_p_sex)%>%
             ggplot(aes(x=c_f_ratio_grade,y=c_speceff,color=c_p_sex))+
             geom_point(color="grey")+
             scale_color_manual(values = nudos_color_binary)+
             geom_smooth(method = "nls", formula = y ~ a * x + b, se = F,
             method.args = list(start = list(a = 0.1, b = 0.1)))+    
             theme_ipsum()+
             labs(x = "Ratio de mujeres 8vo básico (estimado)",
                  y = "Promedio por escuela de autoeficacia general",
                  color= "Género directivo")+
             theme(legend.position = "bottom")+
             scale_x_continuous(labels = scales::percent_format(scale = 100)),
           type = "boxplot")
```
:::

## Relaciones de varianza

```{r}
school %>% 
  select("A. General"=c_geneff, "A. Específica"=c_speceff, "Proporción femenina"=c_f_ratio_grade,
         "Género directivo"=c_p_sex)%>%drop_na()%>%
  cor()%>%
  corrplot(method="square",diag = FALSE,type = "lower",addCoef.col = "#5f5758")
```

# Modelos multinivel

## Modelos nulos {.smaller}

```{r, results='asis'}
data <- data %>% mutate_all(as.numeric)
label(data[["s_geneff"]]) <- "Autoeficacia General"
label(data[["s_speceff"]]) <- "Autoeficacia Específica"
label(data[["s_sex"]]) <- "Género Estudiante (mujer=1)"
label(data[["s_ictfut"]]) <- "Expectativa uso futuro"
label(data[["s_ictpos"]]) <- "Valoración positiva"
label(data[["s_ictneg"]]) <- "Valoración negativa"
label(data[["s_hisced"]]) <- "Nivel Educacional padres (superior=1)"
label(data[["s_homlit"]]) <- "Alfabetización del hogar"
label(data[["c_f_ratio_grade"]]) <- "Proporción Femenina"
label(data[["c_p_sex"]]) <- "Género directivo (mujer=1)"

m0_geneff <- lmer(s_geneff ~ 1  +  (1 | idschool),  data=data)
m0_speceff <- lmer(s_speceff ~ 1  +  (1 | idschool),  data=data)

sjPlot::tab_model(m0_geneff, m0_speceff, 
                  show.ci = FALSE, p.style = "stars",
                  show.re.var = FALSE,
                  collapse.se = TRUE,
                  show.r2 = FALSE)
```

## Nivel 1 {.smaller .scrollable}

```{r, results='asis'}
m1_geneff <- lmer(s_geneff ~ 
                  s_sex + s_ictfut + s_ictpos + s_ictneg +
                  s_hisced + s_homlit +
                  (1 | idschool),  data=data)

m1_speceff <- lmer(s_speceff ~ 
                  s_sex + s_ictfut + s_ictpos + s_ictneg +
                  s_hisced + s_homlit +
                  (1 | idschool),  data=data)

tab_model(m1_geneff, m1_speceff, 
          show.ci = FALSE, auto.label = TRUE,
          p.style = "stars",collapse.se = TRUE,
          show.re.var = FALSE)

```

## Multinivel pendiente fija {.smaller .scrollable}

```{r, results='asis'}
m1_1_geneff <- lmer(s_geneff ~ 
                  c_f_ratio_grade + c_p_sex +
                  s_sex + s_ictfut + s_ictpos + s_ictneg +
                  s_hisced + s_homlit +
                  (1 | idschool),  data=data)

m1_1_speceff <- lmer(s_speceff ~ 
                  c_f_ratio_grade + c_p_sex +
                  s_sex + s_ictfut + s_ictpos + s_ictneg +
                  s_hisced + s_homlit +
                  (1 | idschool),  data=data)

tab_model(m1_1_geneff, m1_1_speceff, 
          show.ci = FALSE, auto.label = TRUE,
          p.style = "stars",collapse.se = TRUE,
          show.re.var = FALSE)

```

## Pendiente aleatoria con moderación {.smaller .scrollable}

```{r, results='asis'}
m2_geneff <- lmer(s_geneff ~ 
                  s_sex*c_f_ratio_grade + s_sex*c_p_sex +
                  c_f_ratio_grade + c_p_sex +
                  s_sex + s_ictfut + s_ictpos + s_ictneg +
                  s_hisced + s_homlit +
                  (1 + s_sex| idschool), data=data)

m2_speceff <- lmer(s_speceff ~ 
                  s_sex*c_f_ratio_grade + s_sex*c_p_sex +
                  c_f_ratio_grade + c_p_sex +
                  s_sex + s_ictfut + s_ictpos + s_ictneg +
                  s_hisced + s_homlit +
                  (1 + s_sex| idschool), data=data)

tab_model(m2_geneff, m2_speceff, 
          show.ci = FALSE, auto.label = TRUE,
          p.style = "stars", collapse.se = TRUE,
          terms = c("s_sex","c_f_ratio_grade",
                    "s_sex:c_f_ratio_grade",
                    "s_sex:c_p_sex"))
```

## ¿Es relevante la composición de género? {.smaller}

#### Autoeficacia Específica

```{r, results='markup'}

interactions::interact_plot(m2_speceff, pred = s_sex, modx = c_f_ratio_grade,
                            colors = nudos_color_binary,legend.main = "Proporción femenina")+
  labs(x="Género", y="Puntaje A. Específica")

```
:::

## Confirmación Hipótesis

*Agregar Modelo con hipótesis rechazadas/aprobadas*

## Conclusiones

*Escribir conclusiones*

## Discusión

-   Limitaciones
    -   Composición de mujeres como categórica
    -   Presentación explorativa (Causalidad actitudes-autoeficacia)
-   Nuevas agendas
    -   Explicar variación de actitudes por género
    -   Añadir tipos de usos y desempeño en la prueba (behavioral perspective)

## Referencias

::: {#refs}
:::
